
{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h4 class="mb-0">Content Planner Â· {{ month_str }}</h4>
  <a href="{{ url_for('planner_new') }}" class="btn btn-primary">+ Add Content</a>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-auto">
    <label class="form-label small mb-0">Client</label>
    <select name="client_id" class="form-select form-select-sm">
      <option value="">All</option>
      {% for c in clients %}
        <option value="{{ c.id }}" {% if selected_client_id==c.id %}selected{% endif %}>{{ c.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-auto">
    <label class="form-label small mb-0">Month</label>
    <input type="month" name="month" class="form-control form-control-sm" value="{{ month_str }}">
  </div>
  <div class="col-auto align-self-end">
    <button class="btn btn-outline-secondary btn-sm" type="submit">Apply</button>
  </div>
</form>

<div class="card card-soft p-3">
  {% if items %}
  <table class="table table-sm align-middle">
    <thead>
      <tr>
        <th>Date</th>
        <th>Client</th>
        <th>Platform</th>
        <th>Type</th>
        <th>Title</th>
        <th>Status</th>
        <th style="width:130px;"></th>
      </tr>
    </thead>
    <tbody>
      {% for i in items %}
      <tr>
        <td>{{ i.date.strftime("%d %b") }}</td>
        <td>{{ i.client.name }}</td>
        <td>{{ i.platform }}</td>
        <td>{{ i.content_type }}</td>
        <td>{{ i.title }}</td>
        <td>
          <span class="badge rounded-pill 
            {% if i.status=='planned' %}pill-planned
            {% elif i.status=='done' %}pill-done
            {% elif i.status=='overdue' %}pill-overdue
            {% else %}pill-skipped{% endif %}">
            {{ i.status|upper }}
          </span>
        </td>
        <td class="text-end">
          <div class="btn-group btn-group-sm" role="group">
            <a href="{{ url_for('planner_edit', item_id=i.id) }}" class="btn btn-outline-secondary">Edit</a>
            <a href="{{ url_for('planner_status', item_id=i.id, status='done') }}" class="btn btn-outline-success">Done</a>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p class="text-muted mb-0">No content planned for this period yet.</p>
  {% endif %}
</div>
{% endblock %}
